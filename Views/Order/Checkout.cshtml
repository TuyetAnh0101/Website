@model SportsStore.Models.Order
@inject Cart Cart

<!-- Bootstrap & FontAwesome -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<style>
    .checkout-card {
        max-width: 1000px;
        margin: 40px auto;
        border-radius: 16px;
        padding: 30px;
        background: white;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .form-control, .form-check-input {
        border-radius: 10px;
        font-size: 16px;
    }

    .order-summary {
        border-radius: 12px;
        border: 1px solid #ccc;
        padding: 16px;
    }

    .order-item {
        display: flex;
        align-items: center;
        margin-bottom: 16px;
    }

    .order-item img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        border-radius: 8px;
        margin-right: 12px;
    }

    .total-line {
        font-weight: bold;
        font-size: 18px;
        margin-top: 10px;
    }

    .btn-order {
        background-color: #1e8141;
        color: white;
        font-weight: bold;
        border-radius: 8px;
        font-size: 18px;
        padding: 12px 24px;
    }

    .btn-order:hover {
        background-color: #166b36;
    }
</style>

<div class="checkout-card row">
    <div class="col-md-6 border-end">
        <h3 class="text-success fw-bold mb-4">RestudyStore</h3>
        <h5 class="mb-3">Thông tin giao hàng</h5>

        <form asp-action="Checkout" method="post" novalidate>
            <div asp-validation-summary="All" class="text-danger mb-3"></div>

            <div class="mb-3">
                <input asp-for="Name" class="form-control" placeholder="Họ và tên" />
                <span asp-validation-for="Name" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <input asp-for="Line1" class="form-control" placeholder="Địa chỉ" />
                <span asp-validation-for="Line1" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <input asp-for="Line2" class="form-control" placeholder="Email" />
                <span asp-validation-for="Line2" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <input asp-for="Line3" class="form-control" placeholder="Số điện thoại" />
                <span asp-validation-for="Line3" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <input asp-for="City" class="form-control" placeholder="Thành phố" />
                <span asp-validation-for="City" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <input asp-for="State" class="form-control" placeholder="Tỉnh / Khu vực" />
                <span asp-validation-for="State" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <input asp-for="Zip" class="form-control" placeholder="Mã bưu điện" />
                <span asp-validation-for="Zip" class="text-danger"></span>
            </div>

            <div class="mb-4">
                <label class="form-check">
                    <input class="form-check-input" type="radio" name="Country" value="Thanh toán khi nhận hàng" checked />
                    <span class="form-check-label">Thanh toán khi nhận hàng</span>
                </label>
                <label class="form-check mt-2">
                    <input class="form-check-input" type="radio" name="Country" value="Chuyển khoản" />
                    <span class="form-check-label">Chuyển khoản</span>
                </label>
                <span asp-validation-for="Country" class="text-danger"></span>
            </div>

            <div class="form-check mb-3">
                <input asp-for="GiftWrap" class="form-check-input" />
                <label class="form-check-label" asp-for="GiftWrap">Gói quà</label>
            </div>

            <button type="submit" class="btn btn-order w-100">ĐẶT HÀNG</button>
        </form>
    </div>

    <div class="col-md-6 ps-4">
        <h5 class="mb-3">Đơn hàng của bạn</h5>
        <div class="order-summary">
            @foreach (var line in Cart.Lines)
            {
                var isRental = line.IsRental;
                var price = isRental ? (line.Product.RentPrice ?? 0) : line.Product.Price;
                var label = isRental ? "Thuê" : "Mua";
                var unit = isRental ? $" × {line.RentalDays} ngày" : "";
                var lineTotal = line.LineTotal;

                <div class="order-item">
                    <img src="/images/@(line.Product.Image ?? "default.jpg")" alt="@line.Product.Name" />
                    <div>
                        <div>@line.Product.Name (@label)</div>
                        <small>@line.Quantity × @price.ToString("N0") đ @Html.Raw(unit)</small>
                    </div>
                    <div class="ms-auto">@lineTotal.ToString("N0") đ</div>
                </div>
            }
            <hr />
            <div class="d-flex justify-content-between total-line">
                <div>TỔNG CỘNG:</div>
                <div>@Cart.ComputeTotalValue().ToString("N0") đ</div>
            </div>
        </div>
    </div>
</div>
